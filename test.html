<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dialogue Conseiller - Candidat</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            width: 1920px;
            height: 1080px;
            overflow: hidden;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .main-container {
            width: 1920px;
            height: 1080px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 40px;
            gap: 40px;
        }

        /* Section gauche : Audio + Transcription */
        .left-section {
            width: 55%;
            height: 100%;
            display: flex;
            flex-direction: column;
            gap: 25px;
        }

        /* Lecteur Audio */
        .audio-section {
            background: white;
            border-radius: 25px;
            padding: 35px;
            box-shadow: 0 15px 50px rgba(0,0,0,0.2);
        }

        .audio-title {
            font-size: 28px;
            color: #667eea;
            margin-bottom: 25px;
            text-align: center;
            font-weight: 600;
        }

        .audio-controls {
            display: flex;
            align-items: center;
            gap: 20px;
            justify-content: center;
        }

        .play-btn {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
            transition: all 0.3s ease;
        }

        .play-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 12px 35px rgba(102, 126, 234, 0.5);
        }

        .play-btn svg {
            width: 35px;
            height: 35px;
            fill: white;
        }

        .progress-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .progress-bar-wrapper {
            width: 100%;
            height: 12px;
            background: #e0e0e0;
            border-radius: 6px;
            cursor: pointer;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            width: 0%;
            border-radius: 6px;
            transition: width 0.1s linear;
        }

        .time-display {
            display: flex;
            justify-content: space-between;
            font-size: 14px;
            color: #666;
        }

        .speed-control {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 14px;
            color: #666;
        }

        .speed-btn {
            padding: 8px 15px;
            border: 2px solid #667eea;
            background: white;
            color: #667eea;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s;
        }

        .speed-btn.active, .speed-btn:hover {
            background: #667eea;
            color: white;
        }

        /* Transcription */
        .transcription-section {
            flex: 1;
            background: white;
            border-radius: 25px;
            padding: 30px;
            box-shadow: 0 15px 50px rgba(0,0,0,0.2);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .transcription-title {
            font-size: 22px;
            color: #764ba2;
            margin-bottom: 20px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .transcription-content {
            flex: 1;
            overflow-y: auto;
            padding-right: 15px;
            line-height: 1.8;
            font-size: 16px;
        }

        .transcription-content::-webkit-scrollbar {
            width: 8px;
        }

        .transcription-content::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }

        .transcription-content::-webkit-scrollbar-thumb {
            background: #667eea;
            border-radius: 4px;
        }

        .dialogue-line {
            margin-bottom: 15px;
            padding: 12px 15px;
            border-radius: 10px;
            transition: background 0.3s;
        }

        .dialogue-line.active {
            background: #f3e5f5;
        }

        .dialogue-line.conseiller {
            border-left: 4px solid #9c27b0;
        }

        .dialogue-line.candidat {
            border-left: 4px solid #2196F3;
        }

        .speaker-name {
            font-weight: 700;
            color: #333;
            margin-bottom: 5px;
        }

        .speaker-name.conseiller { color: #9c27b0; }
        .speaker-name.candidat { color: #2196F3; }

        /* Section droite : Flashcards */
        .right-section {
            width: 45%;
            height: 100%;
            display: flex;
            flex-direction: column;
            gap: 25px;
        }

        .flashcards-title {
            background: white;
            border-radius: 20px;
            padding: 20px 30px;
            text-align: center;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }

        .flashcards-title h2 {
            font-size: 26px;
            color: #667eea;
            margin-bottom: 8px;
        }

        .flashcards-title p {
            font-size: 16px;
            color: #666;
        }

        .flashcards-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .flashcard {
            flex: 1;
            perspective: 1000px;
            cursor: pointer;
        }

        .flashcard-inner {
            position: relative;
            width: 100%;
            height: 100%;
            transition: transform 0.6s;
            transform-style: preserve-3d;
        }

        .flashcard.flipped .flashcard-inner {
            transform: rotateY(180deg);
        }

        .flashcard-front, .flashcard-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 20px;
            padding: 25px 30px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            box-shadow: 0 10px 40px rgba(0,0,0,0.15);
        }

        .flashcard-front {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .flashcard-back {
            background: white;
            transform: rotateY(180deg);
            border: 3px solid #667eea;
        }

        .flashcard.correct .flashcard-back {
            border-color: #4CAF50;
            background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
        }

        .flashcard.incorrect .flashcard-back {
            border-color: #f44336;
            background: linear-gradient(135deg, #ffebee 0%, #ffcdd2 100%);
        }

        .card-label {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 10px;
            opacity: 0.9;
        }

        .flashcard-front .card-label {
            color: rgba(255,255,255,0.8);
        }

        .flashcard-back .card-label {
            color: #667eea;
        }

        .flashcard.correct .flashcard-back .card-label {
            color: #4CAF50;
        }

        .flashcard.incorrect .flashcard-back .card-label {
            color: #f44336;
        }

        .card-content {
            font-size: 18px;
            line-height: 1.6;
        }

        .flashcard-front .card-content {
            font-weight: 500;
        }

        .flashcard-back .card-content {
            color: #333;
        }

        .card-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 28px;
        }

        .flip-hint {
            position: absolute;
            bottom: 15px;
            right: 20px;
            font-size: 13px;
            opacity: 0.7;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .flip-hint svg {
            width: 16px;
            height: 16px;
        }
    </style>
</head>
<body>
    <div class="main-container">
        <!-- Section Gauche : Audio + Transcription -->
        <div class="left-section">
            <!-- Lecteur Audio -->
            <div class="audio-section">
                <h2 class="audio-title">üéß √âcoutez le dialogue</h2>
                <div class="audio-controls">
                    <button class="play-btn" id="playBtn" onclick="togglePlay()">
                        <svg id="playIcon" viewBox="0 0 24 24">
                            <path d="M8 5v14l11-7z"/>
                        </svg>
                        <svg id="pauseIcon" style="display:none" viewBox="0 0 24 24">
                            <path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/>
                        </svg>
                    </button>
                    <div class="progress-container">
                        <div class="progress-bar-wrapper" onclick="seekAudio(event)">
                            <div class="progress-bar" id="progressBar"></div>
                        </div>
                        <div class="time-display">
                            <span id="currentTime">0:00</span>
                            <span id="totalTime">0:00</span>
                        </div>
                    </div>
                    <div class="speed-control">
                        <span>Vitesse :</span>
                        <button class="speed-btn" onclick="setSpeed(0.75)">0.75x</button>
                        <button class="speed-btn active" onclick="setSpeed(1)">1x</button>
                        <button class="speed-btn" onclick="setSpeed(1.25)">1.25x</button>
                    </div>
                </div>
            </div>

            <!-- Transcription -->
            <div class="transcription-section">
                <h3 class="transcription-title">üìù Transcription du dialogue</h3>
                <div class="transcription-content" id="transcription"></div>
            </div>
        </div>

        <!-- Section Droite : Flashcards -->
        <div class="right-section">
            <div class="flashcards-title">
                <h2>üÉè Testez vos connaissances</h2>
                <p>Cliquez sur les cartes pour les retourner</p>
            </div>
            <div class="flashcards-container" id="flashcardsContainer"></div>
        </div>
    </div>

    <script>
        // Dialogue data
        const dialogueLines = [
            { speaker: "conseiller", text: "Bonjour, merci d'√™tre l√†. Avant de parler du dispositif, j'aimerais comprendre votre situation. Qu'est-ce qui vous motive √† passer ce certificat ?" },
            { speaker: "candidat", text: "J'ai envie de faire reconna√Ætre ce que je fais au travail‚Ä¶ mais je vous le dis tout de suite : l'√©cole, √ßa fait longtemps. Et la r√©daction, je ne suis pas √† l'aise." },
            { speaker: "conseiller", text: "C'est important que vous me le disiez. Quand vous dites \"r√©daction\", c'est plut√¥t le fait d'√©crire longtemps, de structurer, ou la peur de \"faire faux\" ?" },
            { speaker: "candidat", text: "Un peu tout. Je peux expliquer √† l'oral, mais √©crire une page‚Ä¶ je bloque. Et je n'ai pas envie de me retrouver \"en examen\"." },
            { speaker: "conseiller", text: "D'accord. On va donc √©viter une approche qui vous met en difficult√© sur ce point. Est-ce que dans votre travail, vous avez des choses concr√®tes qui montrent ce que vous faites : traces, documents, outils, captures, exemples ?" },
            { speaker: "candidat", text: "Oui. Je g√®re des commandes, j'ai des mails, des tableaux, des photos, des captures d'√©cran‚Ä¶ et parfois des retours clients." },
            { speaker: "conseiller", text: "Parfait. Ce type d'√©l√©ments peut justement servir √† appuyer votre d√©marche. L'id√©e, ce n'est pas de vous demander de \"raconter l'√©cole\", mais de partir de votre r√©alit√© de terrain." },
            { speaker: "candidat", text: "Donc je ne vais pas devoir r√©diger un gros dossier ?" },
            { speaker: "conseiller", text: "Non. On peut partir sur quelque chose qui se construit progressivement, √† partir de preuves li√©es √† votre activit√©. Vous avancez √©tape par √©tape, et on fait des points √† des moments cl√©s." },
            { speaker: "candidat", text: "√áa me rassure‚Ä¶ parce que je travaille, je ne peux pas me bloquer une semaine enti√®re." },
            { speaker: "conseiller", text: "Je comprends. L√†, vous pouvez organiser votre progression en fonction de vos contraintes. Et si c'est plus simple pour vous, une partie des √©changes peut aussi se faire √† distance." },
            { speaker: "candidat", text: "√Ä distance, c'est possible ?" },
            { speaker: "conseiller", text: "Oui, selon les modalit√©s pr√©vues, on peut faire un entretien en visio. L'important c'est que vous puissiez expliquer ce que vous avez produit ou choisi comme √©l√©ments." },
            { speaker: "candidat", text: "Je pr√©f√®re largement. Parce qu'√† l'oral, je me d√©brouille." },
            { speaker: "conseiller", text: "C'est justement pour √ßa qu'on prend le temps de choisir le bon format avec vous. Et si vous avez besoin, vous n'√™tes pas seul : il y a un accompagnement possible pour vous aider √† s√©lectionner les √©l√©ments et √† les rendre exploitables." },
            { speaker: "candidat", text: "L√†, je me vois le faire. Si je peux m'appuyer sur ce que je fais d√©j√†, et pas sur des dissertations‚Ä¶" },
            { speaker: "conseiller", text: "C'est exactement l'objectif : partir de votre pratique et la rendre lisible, sans vous imposer un cadre trop scolaire." }
        ];

        // Flashcards data
        const flashcards = [
            {
                front: "Le portefeuille de preuves permet une organisation plus souple du parcours de certification.",
                back: "Cette modalit√© repose sur un travail √©tal√© dans le temps, compatible avec l'activit√© professionnelle. Elle ne n√©cessite pas une mobilisation continue ou une session longue, et peut s'adapter aux contraintes de planning des candidats et des entreprises.",
                correct: true
            },
            {
                front: "Le portefeuille de preuves valorise des situations professionnelles r√©elles.",
                back: "Les comp√©tences sont d√©montr√©es √† partir d'√©l√©ments issus de l'activit√© effective, tels que des productions, documents ou traces de travail. Cette approche limite le recours √† des formats scolaires ou th√©oriques et s'appuie sur des preuves concr√®tes.",
                correct: true
            },
            {
                front: "Le portefeuille de preuves ne n√©cessite ni pr√©paration ni accompagnement.",
                back: "Cette affirmation est incorrecte. Le portefeuille de preuves implique un travail de s√©lection et de structuration des √©l√©ments pr√©sent√©s. Un accompagnement peut √™tre mobilis√© pour s√©curiser cette d√©marche et faciliter la compr√©hension des attendus.",
                correct: false
            }
        ];

        // Audio state
        let isPlaying = false;
        let currentUtterance = null;
        let currentLineIndex = 0;
        let speechRate = 1;
        let isPaused = false;
        let totalDuration = 0;
        let elapsedTime = 0;
        let progressInterval = null;

        // Initialize transcription
        function initTranscription() {
            const container = document.getElementById('transcription');
            dialogueLines.forEach((line, index) => {
                const div = document.createElement('div');
                div.className = `dialogue-line ${line.speaker}`;
                div.id = `line-${index}`;
                div.innerHTML = `
                    <div class="speaker-name ${line.speaker}">${line.speaker === 'conseiller' ? 'üíº Conseiller' : 'üë§ Candidat'}</div>
                    <div>${line.text}</div>
                `;
                container.appendChild(div);
            });
        }

        // Initialize flashcards
        function initFlashcards() {
            const container = document.getElementById('flashcardsContainer');
            flashcards.forEach((card, index) => {
                const div = document.createElement('div');
                div.className = `flashcard ${card.correct ? 'correct' : 'incorrect'}`;
                div.innerHTML = `
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <span class="card-badge">${card.correct ? '‚úÖ' : '‚ùå'}</span>
                            <div class="card-label">AFFIRMATION ${index + 1}</div>
                            <div class="card-content">${card.front}</div>
                            <div class="flip-hint">
                                <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"/></svg>
                                Cliquez pour retourner
                            </div>
                        </div>
                        <div class="flashcard-back">
                            <span class="card-badge">${card.correct ? '‚úÖ' : '‚ùå'}</span>
                            <div class="card-label">${card.correct ? 'VRAI' : 'FAUX'} ‚Äî EXPLICATION</div>
                            <div class="card-content">${card.back}</div>
                            <div class="flip-hint">
                                <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"/></svg>
                                Cliquez pour retourner
                            </div>
                        </div>
                    </div>
                `;
                div.addEventListener('click', () => {
                    div.classList.toggle('flipped');
                });
                container.appendChild(div);
            });
        }

        // Calculate estimated duration
        function calculateDuration() {
            const totalChars = dialogueLines.reduce((sum, line) => sum + line.text.length, 0);
            // Approximate: 15 characters per second at normal speed
            totalDuration = Math.ceil(totalChars / 15);
            document.getElementById('totalTime').textContent = formatTime(totalDuration);
        }

        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            return `${mins}:${secs.toString().padStart(2, '0')}`;
        }

        // Speech synthesis
        function speakLine(index) {
            if (index >= dialogueLines.length) {
                stopAudio();
                return;
            }

            currentLineIndex = index;
            highlightLine(index);

            const line = dialogueLines[index];
            currentUtterance = new SpeechSynthesisUtterance(line.text);
            currentUtterance.lang = 'fr-FR';
            currentUtterance.rate = speechRate;
            
            // Different pitch for different speakers
            currentUtterance.pitch = line.speaker === 'conseiller' ? 0.9 : 1.1;

            currentUtterance.onend = () => {
                if (isPlaying && !isPaused) {
                    speakLine(index + 1);
                }
            };

            speechSynthesis.speak(currentUtterance);
        }

        function highlightLine(index) {
            // Remove previous highlight
            document.querySelectorAll('.dialogue-line').forEach(el => {
                el.classList.remove('active');
            });
            
            // Add new highlight
            const lineEl = document.getElementById(`line-${index}`);
            if (lineEl) {
                lineEl.classList.add('active');
                lineEl.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
        }

        function togglePlay() {
            if (isPlaying) {
                pauseAudio();
            } else {
                playAudio();
            }
        }

        function playAudio() {
            isPlaying = true;
            isPaused = false;
            document.getElementById('playIcon').style.display = 'none';
            document.getElementById('pauseIcon').style.display = 'block';

            if (speechSynthesis.paused) {
                speechSynthesis.resume();
            } else {
                speakLine(currentLineIndex);
            }

            // Start progress tracking
            progressInterval = setInterval(updateProgress, 100);
        }

        function pauseAudio() {
            isPlaying = false;
            isPaused = true;
            document.getElementById('playIcon').style.display = 'block';
            document.getElementById('pauseIcon').style.display = 'none';
            
            speechSynthesis.pause();
            clearInterval(progressInterval);
        }

        function stopAudio() {
            isPlaying = false;
            isPaused = false;
            currentLineIndex = 0;
            elapsedTime = 0;
            document.getElementById('playIcon').style.display = 'block';
            document.getElementById('pauseIcon').style.display = 'none';
            document.getElementById('progressBar').style.width = '0%';
            document.getElementById('currentTime').textContent = '0:00';
            
            speechSynthesis.cancel();
            clearInterval(progressInterval);
            
            document.querySelectorAll('.dialogue-line').forEach(el => {
                el.classList.remove('active');
            });
        }

        function updateProgress() {
            if (isPlaying) {
                elapsedTime += 0.1;
                const progress = Math.min((elapsedTime / totalDuration) * 100, 100);
                document.getElementById('progressBar').style.width = progress + '%';
                document.getElementById('currentTime').textContent = formatTime(elapsedTime);
            }
        }

        function seekAudio(event) {
            const wrapper = event.currentTarget;
            const rect = wrapper.getBoundingClientRect();
            const clickX = event.clientX - rect.left;
            const percentage = clickX / rect.width;
            
            // Calculate which line to jump to
            const targetLine = Math.floor(percentage * dialogueLines.length);
            
            speechSynthesis.cancel();
            currentLineIndex = targetLine;
            elapsedTime = percentage * totalDuration;
            
            document.getElementById('progressBar').style.width = (percentage * 100) + '%';
            document.getElementById('currentTime').textContent = formatTime(elapsedTime);
            
            if (isPlaying) {
                speakLine(currentLineIndex);
            }
        }

        function setSpeed(speed) {
            speechRate = speed;
            document.querySelectorAll('.speed-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.textContent === speed + 'x') {
                    btn.classList.add('active');
                }
            });
            
            // If currently playing, restart current line with new speed
            if (isPlaying) {
                speechSynthesis.cancel();
                speakLine(currentLineIndex);
            }
        }

        // Initialize
        initTranscription();
        initFlashcards();
        calculateDuration();
    </script>
</body>
</html>
